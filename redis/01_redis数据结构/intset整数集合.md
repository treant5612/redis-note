### 整数集合

整数集合用于保存int16 int32 或者int64的集合数据结构，集合中没有重复元素。

contents的类型并不代表实际类型，实际类型由encoding属性决定。保存时如果所有元素都在int16范围内就是该数组就是int16的，如果插入一个int64类型的整数，该数组的所有元素都会被转为int64类型，即整数集合的升级。

> 集合键的底层实现之一。实现为有序/无重复数组。

#### 升级

当将一个新元素添加到整数集合，且新元素的类型比整数集合现有类型大时，整数集合需要先升级，才能完成添加操作。 

- 根据新元素类型，扩展底层数组大小，并为新元素预留空间。（realloc扩展空间）
- 将现有元素转为与新元素相同的类型，并将原有的元素移动到新的位置
- 将新元素添加到底层数组中。

> 整数集合完成升级之后就无法再降级



#### 插入数据

- 检测是否需要升级，如需要升级，进行升级
- 检测数据是否存在，如存在，将success设为0，返回未改动的整数集合
- 扩展空间，移动现有元素，空出新元素的位置。
- 将新元素设置到其位置，将元素数量计数器+1



#### 结构体

``` c
typedef struct intset {
    
    // 编码方式
    uint32_t encoding;

    // 集合包含的元素数量
    uint32_t length;

    // 保存元素的数组
    int8_t contents[];

} intset;
```

